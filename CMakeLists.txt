cmake_minimum_required(VERSION 3.21)

project(
        CxxLazy
        VERSION 0.1.0
        DESCRIPTION "Thread-safe lazy initialization for modern C++ | ç°ä»£ C++ çš„çº¿ç¨‹å®‰å…¨æƒ°æ€§åˆå§‹åŒ–"
        HOMEPAGE_URL "https://github.com/uyplayer/CxxLazy"
        LANGUAGES CXX
)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)



set(CMAKE_EXPORT_COMPILE_COMMANDS ON)
set_property(GLOBAL PROPERTY USE_FOLDERS ON)

message(STATUS "ğŸ› ï¸ æ£€æµ‹åˆ°ç¼–è¯‘å™¨: ${CMAKE_CXX_COMPILER_ID} ${CMAKE_CXX_COMPILER_VERSION}")

if (CMAKE_CXX_COMPILER_ID MATCHES "GNU|Clang")
    add_compile_options(
            -Wall
            -Wextra
            -Wpedantic
            -Werror
            -Wno-unused-parameter
    )
    message(STATUS "âš™ï¸ å¯ç”¨ GCC/Clang ç¼–è¯‘é€‰é¡¹: -Wall -Wextra -Wpedantic -Werror -Wno-unused-parameter")

elseif (MSVC)
    add_compile_options(/W4 /WX)
    message(STATUS "âš™ï¸ MSVC ç¼–è¯‘é€‰é¡¹å¯ç”¨: /W4 /WX")
endif()


message(STATUS ${CMAKE_BINARY_DIR})
include(${CMAKE_BINARY_DIR}/generators/conan_toolchain.cmake OPTIONAL)

message(STATUS "é¡¹ç›®æ ¹ç›®å½• : ${CMAKE_SOURCE_DIR}")
message(STATUS "å½“å‰ç›®å½• : ${CMAKE_CURRENT_SOURCE_DIR}")
add_definitions(-DPROJECT_ROOT="${CMAKE_SOURCE_DIR}")

enable_testing()
find_package(Catch2 REQUIRED)


add_subdirectory(tests)
add_subdirectory(src)